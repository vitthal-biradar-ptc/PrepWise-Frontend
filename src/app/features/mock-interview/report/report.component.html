<app-header></app-header>

<div class="learning-path-container">
  <div class="main-content">
    <div class="header-section">
      <h1 class="page-title">Interview Report</h1>
      <div class="time-estimate">
        <span class="time-icon">üìä</span>
        Detailed analysis of your interview performance
      </div>
    </div>

    <div class="progress-overview">
      @if (isLoading) {
      <div class="w-full h-96 flex flex-col items-center justify-center">
        <div class="relative">
          <div
            class="w-16 h-16 border-4 border-gray-700 rounded-full animate-pulse"
          ></div>
          <div
            class="absolute top-0 left-0 w-16 h-16 border-t-4 border-indigo-500 rounded-full animate-spin"
          ></div>
        </div>
        <h4 class="text-2xl font-bold mt-6 theme-light">
          Loading Your Report...
        </h4>
        <p class="theme-muted mt-2 text-center max-w-md">
          We're preparing your detailed interview analysis.
        </p>
      </div>
      } @else if (error) {
      <div
        class="w-full h-96 flex flex-col items-center justify-center text-center"
      >
        <div
          class="bg-red-500/10 border border-red-500/20 rounded-full p-4 mb-4"
        >
          <svg
            class="w-12 h-12 text-red-400"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            ></path>
          </svg>
        </div>
        <h4 class="text-2xl font-bold text-red-400 mb-2">
          Unable to Load Report
        </h4>
        <p class="theme-muted mb-6 max-w-md">{{ error }}</p>
        <div class="flex gap-3">
          <button
            (click)="loadReport()"
            class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300"
          >
            Try Again
          </button>
          <button
            (click)="goBackToReports()"
            class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300"
          >
            Back to Reports
          </button>
        </div>
      </div>
      } @else if (report) {
      <div class="periods-container">
        <div class="period-card expanded">
          <div class="period-header">
            <div class="period-header-content">
              <div class="period-info">
                <h3 class="period-title">{{ report.role }} Interview</h3>
                <p class="period-goal">
                  Level: {{ report.level }} ‚Ä¢ Score:
                  {{ report.overallScore }}/10
                </p>
              </div>
              <div class="period-stats">
                <div class="period-progress">
                  <span class="mini-progress-text"
                    >{{ report.duration }} mins</span
                  >
                </div>
              </div>
            </div>
          </div>

          <div class="period-content expanded">
            <div class="period-content-inner">
              @if (report.overallSummary) {
              <div class="section">
                <h4 class="section-title">
                  <span class="section-icon">üìù</span>
                  Overall Summary
                </h4>
                <p class="empty-state-description">
                  {{ report.overallSummary }}
                </p>
              </div>
              }

              <div
                class="section"
                *ngIf="report.strengths && report.strengths.length"
              >
                <h4 class="section-title">
                  <span class="section-icon">‚úÖ</span>
                  Key Strengths
                </h4>
                <ul class="focus-areas-list">
                  <li
                    class="focus-area-item"
                    *ngFor="let strength of report.strengths"
                  >
                    {{ strength }}
                  </li>
                </ul>
              </div>

              <div
                class="section"
                *ngIf="
                  report.areasForImprovement &&
                  report.areasForImprovement.length
                "
              >
                <h4 class="section-title">
                  <span class="section-icon">‚ö†Ô∏è</span>
                  Areas for Growth
                </h4>
                <ul class="focus-areas-list">
                  <li
                    class="focus-area-item"
                    *ngFor="let area of report.areasForImprovement"
                  >
                    {{ area }}
                  </li>
                </ul>
              </div>

              <div class="section" *ngIf="report.recommendations">
                <h4 class="section-title">
                  <span class="section-icon">üí°</span>
                  Recommendations
                </h4>
                <p class="empty-state-description">
                  {{ report.recommendations }}
                </p>
              </div>

              <div class="section">
                <h4 class="section-title">
                  <span class="section-icon">üóíÔ∏è</span>
                  Interview Transcript
                </h4>
                <div class="resources-grid" style="gap: 0.5rem">
                  <div
                    class="resource-item"
                    *ngFor="let item of report.transcript"
                  >
                    <span class="resource-icon">{{
                      item.speaker === "Candidate" ? "üë§" : "ü§ñ"
                    }}</span>
                    <div class="resource-content">
                      <span class="resource-title">{{ item.speaker }}</span>
                      <span class="resource-type">{{ item.text }}</span>
                    </div>
                    <span class="external-link-icon">{{
                      item.timestamp | date : "h:mm a"
                    }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      }
    </div>
  </div>
</div>
<app-footer></app-footer>
