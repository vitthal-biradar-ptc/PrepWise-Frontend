<div class="dashboard-container" style="background-color: #1A1A1A; color: #F1F1F1;">
  <!-- Header Component -->
  <app-header></app-header>
  
  <!-- Toast for notifications -->
  <p-toast></p-toast>

  <!-- Profile Section -->
  <div class="profile-container">
    <div class="profile-card" style="background-color: #1A1A1A; border: 1px solid rgba(176, 62, 255, 0.3); border-radius: 1rem; box-shadow: 0 8px 32px rgba(31, 38, 135, 0.1);">
      <div class="profile-header">
        <!-- Profile Photo Section -->
        <div class="profile-photo-section">
          <p-avatar 
            [image]="profile.photo || 'https://via.placeholder.com/150'" 
            size="xlarge" 
            shape="circle"
            class="profile-photo"
            [style]="{'width': '120px', 'height': '120px', 'object-fit': 'cover', 'border': '2px solid rgba(176, 62, 255, 0.5)'}"
            imageAriaLabel="Profile photo">
          </p-avatar>
          <div class="profile-info">
            <div class="name-section">
              <h1 class="profile-name" *ngIf="!isProfileEditing">{{ profile.name || 'Loading...' }}</h1>
              <input 
                pInputText 
                [(ngModel)]="profile.name" 
                *ngIf="isProfileEditing"
                class="edit-input profile-name-input"
                placeholder="Enter your name">
            </div>
            
            <div class="email-section">
              <p class="profile-email" *ngIf="!isProfileEditing">{{ profile.email || 'Loading...' }}</p>
              <input 
                pInputText 
                [(ngModel)]="profile.email" 
                *ngIf="isProfileEditing"
                class="edit-input"
                placeholder="Enter your email">
            </div>

            <div class="location-section">
              <p class="profile-location" *ngIf="!isProfileEditing">
                <i class="pi pi-map-marker"></i> {{ profile.location || 'Loading...' }}
              </p>
              <input 
                pInputText 
                [(ngModel)]="profile.location" 
                *ngIf="isProfileEditing"
                class="edit-input"
                placeholder="Enter your location">
            </div>
          </div>
        </div>

        <div class="profile-actions">
          <div class="domain-badge">
            <p-chip 
              [label]="profile.domain || 'General'" 
              icon="pi pi-briefcase"
              class="domain-chip">
            </p-chip>
          </div>
          
          <div class="edit-profile-btn">
            <p-button 
              [icon]="isProfileEditing ? 'pi pi-check' : 'pi pi-pencil'"
              [label]="isProfileEditing ? 'Save' : 'Edit Profile'"
              (onClick)="isProfileEditing ? saveProfile() : toggleProfileEditing()"
              class="edit-btn">
            </p-button>
          </div>
        </div>
      </div>

      <div class="social-links">
        <div class="social-link" *ngIf="!isProfileEditing && profile.githubUrl">
          <a [href]="profile.githubUrl" target="_blank" class="social-btn github">
            <i class="pi pi-github"></i>
            <span>GitHub</span>
          </a>
        </div>
        <div class="social-link" *ngIf="!isProfileEditing && profile.linkedinUrl">
          <a [href]="profile.linkedinUrl" target="_blank" class="social-btn linkedin">
            <i class="pi pi-linkedin"></i>
            <span>LinkedIn</span>
          </a>
        </div>
        <div class="social-link" *ngIf="!isProfileEditing && profile.portfolioUrl">
          <a [href]="profile.portfolioUrl" target="_blank" class="social-btn portfolio">
            <i class="pi pi-globe"></i>
            <span>Portfolio</span>
          </a>
        </div>

        <!-- Social links editing -->
        <div class="social-links-edit" *ngIf="isProfileEditing">
          <div class="social-input-group">
            <label>GitHub URL:</label>
            <input pInputText [(ngModel)]="profile.githubUrl" placeholder="https://github.com/username">
          </div>
          <div class="social-input-group">
            <label>LinkedIn URL:</label>
            <input pInputText [(ngModel)]="profile.linkedinUrl" placeholder="https://linkedin.com/in/username">
          </div>
          <div class="social-input-group">
            <label>Portfolio URL:</label>
            <input pInputText [(ngModel)]="profile.portfolioUrl" placeholder="https://your-portfolio.com">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="charts-section">
    <div class="chart-container">
      <p-card class="chart-card" [style]="{'background-color': '#1A1A1A', 'border': '1px solid rgba(176, 62, 255, 0.3)', 'border-radius': '1rem'}">
        <ng-template pTemplate="header">
          <div class="chart-header" style="color: #F5F5DC;">
            <h3>Domain Analysis</h3>
            <i class="pi pi-chart-pie" style="color: #B03EFF;"></i>
          </div>
        </ng-template>
        <div class="chart-content">
          <p-chart 
            *ngIf="domainChartData"
            type="pie" 
            [data]="domainChartData" 
            [options]="domainChartOptions"
            class="w-full">
          </p-chart>
        </div>
      </p-card>
    </div>

    <div class="chart-container">
      <p-card class="chart-card" [style]="{'background-color': '#1A1A1A', 'border': '1px solid rgba(176, 62, 255, 0.3)', 'border-radius': '1rem'}">
        <ng-template pTemplate="header">
          <div class="chart-header" style="color: #F5F5DC;">
            <h3>Performance Metrics</h3>
            <i class="pi pi-chart-line" style="color: #B03EFF;"></i>
          </div>
        </ng-template>
        <div class="chart-content">
          <p-chart 
            *ngIf="atsChartData"
            type="polarArea" 
            [data]="atsChartData" 
            [options]="atsChartOptions"
            class="w-full">
          </p-chart>
        </div>
      </p-card>
    </div>
  </div>

  <!-- Skills Section -->
  <div class="skills-section">
    <p-card class="skills-card" [style]="{'background-color': '#1A1A1A', 'border': '1px solid rgba(176, 62, 255, 0.3)', 'border-radius': '1rem'}">
      <ng-template pTemplate="header">
        <div class="section-header" style="color: #F5F5DC;">
          <h3>Skills</h3>
          <p-button 
            icon="pi pi-plus" 
            label="Add Skill"
            (onClick)="showAddSkillDialog = true"
            class="add-btn"
            [style]="{'background': 'linear-gradient(to right, #7F00FF, #C400FF)', 'border': 'none'}">
          </p-button>
        </div>
      </ng-template>
      
      <div class="skills-grid">
        <div class="skill-item" *ngFor="let skill of skills" style="background-color: rgba(176, 62, 255, 0.1); border: 1px solid rgba(176, 62, 255, 0.2); border-radius: 0.5rem;">
          <div class="skill-content" *ngIf="!skill.isEditing">
            <div class="skill-info">
              <h4 class="skill-name">{{ skill.name }}</h4>
              <p class="skill-category">{{ skill.category }}</p>
            </div>
            <div class="skill-level">
              <p-badge 
                [value]="skill.level" 
                [style]="{'background-color': getLevelColor(skill.level)}">
              </p-badge>
            </div>
            <div class="skill-actions">
              <p-button 
                icon="pi pi-pencil" 
                severity="secondary"
                (onClick)="editSkill(skill)"
                class="action-btn">
              </p-button>
              <p-button 
                icon="pi pi-trash" 
                severity="danger"
                (onClick)="deleteSkill(skill.id)"
                class="action-btn">
              </p-button>
            </div>
          </div>

          <div class="skill-edit" *ngIf="skill.isEditing">
            <div class="edit-inputs">
              <input pInputText [(ngModel)]="skill.name" placeholder="Skill name" class="edit-input">
              <input pInputText [(ngModel)]="skill.category" placeholder="Category" class="edit-input">
              <select pInputText [(ngModel)]="skill.level" class="edit-input">
                <option value="Beginner">Beginner</option>
                <option value="Intermediate">Intermediate</option>
                <option value="Advanced">Advanced</option>
                <option value="Expert">Expert</option>
              </select>
            </div>
            <div class="edit-actions">
              <p-button 
                icon="pi pi-check" 
                severity="success"
                (onClick)="saveSkill(skill)"
                class="action-btn">
              </p-button>
              <p-button 
                icon="pi pi-times" 
                severity="secondary"
                (onClick)="skill.isEditing = false"
                class="action-btn">
              </p-button>
            </div>
          </div>
        </div>
        
        <!-- Show message if no skills -->
        <div *ngIf="skills?.length === 0" style="text-align: center; color: #A7A7A7; padding: 2rem;">
          <p>No skills added yet. Click "Add Skill" to get started!</p>
        </div>
      </div>
    </p-card>
  </div>

  <!-- Certifications and Achievements Section -->
  <div class="certifications-section">
    <div class="certifications-container">
      <p-card class="certifications-card" [style]="{'background-color': '#1A1A1A', 'border': '1px solid rgba(176, 62, 255, 0.3)', 'border-radius': '1rem'}">
        <ng-template pTemplate="header">
          <div class="section-header" style="color: #F5F5DC;">
            <h3>Certifications</h3>
            <p-button 
              icon="pi pi-plus" 
              label="Add Certification"
              (onClick)="showAddCertificationDialog = true"
              class="add-btn"
              [style]="{'background': 'linear-gradient(to right, #7F00FF, #C400FF)', 'border': 'none'}">
            </p-button>
          </div>
        </ng-template>
        
        <div class="certifications-list">
          <div class="certification-item" *ngFor="let cert of certifications" style="background-color: rgba(176, 62, 255, 0.1); border: 1px solid rgba(176, 62, 255, 0.2); border-radius: 0.5rem; margin-bottom: 1rem;">
            <div class="certification-content" *ngIf="!cert.isEditing">
              <div class="certification-info">
                <h4 class="certification-name">{{ cert.name }}</h4>
                <p class="certification-issuer">{{ cert.issuer }}</p>
                <p class="certification-date">{{ cert.date | date:'mediumDate' }}</p>
                <p class="certification-description">{{ cert.description }}</p>
              </div>
              <div class="certification-actions">
                <p-button 
                  icon="pi pi-pencil" 
                  severity="secondary"
                  (onClick)="editCertification(cert)"
                  class="action-btn">
                </p-button>
                <p-button 
                  icon="pi pi-trash" 
                  severity="danger"
                  (onClick)="deleteCertification(cert.id)"
                  class="action-btn">
                </p-button>
              </div>
            </div>

            <div class="certification-edit" *ngIf="cert.isEditing">
              <div class="edit-inputs">
                <input pInputText [(ngModel)]="cert.name" placeholder="Certification name" class="edit-input">
                <input pInputText [(ngModel)]="cert.issuer" placeholder="Issuing organization" class="edit-input">
                <input pInputText type="date" [(ngModel)]="cert.date" class="edit-input">
                <textarea 
                  pInputTextarea 
                  [(ngModel)]="cert.description" 
                  placeholder="Description"
                  rows="3"
                  class="edit-input">
                </textarea>
              </div>
              <div class="edit-actions">
                <p-button 
                  icon="pi pi-check" 
                  severity="success"
                  (onClick)="saveCertification(cert)"
                  class="action-btn">
                </p-button>
                <p-button 
                  icon="pi pi-times" 
                  severity="secondary"
                  (onClick)="cert.isEditing = false"
                  class="action-btn">
                </p-button>
              </div>
            </div>
          </div>
        </div>
      </p-card>
    </div>

    <div class="achievements-container">
      <p-card class="achievements-card" [style]="{'background-color': '#1A1A1A', 'border': '1px solid rgba(176, 62, 255, 0.3)', 'border-radius': '1rem'}">
        <ng-template pTemplate="header">
          <div class="section-header" style="color: #F5F5DC;">
            <h3>Achievements</h3>
            <p-button 
              icon="pi pi-plus" 
              label="Add Achievement"
              (onClick)="showAddAchievementDialog = true"
              class="add-btn"
              [style]="{'background': 'linear-gradient(to right, #7F00FF, #C400FF)', 'border': 'none'}">
            </p-button>
          </div>
        </ng-template>
        
        <div class="achievements-list">
          <div class="achievement-item" *ngFor="let achievement of achievements" style="background-color: rgba(176, 62, 255, 0.1); border: 1px solid rgba(176, 62, 255, 0.2); border-radius: 0.5rem; margin-bottom: 1rem;">
            <div class="achievement-content" *ngIf="!achievement.isEditing">
              <div class="achievement-info">
                <h4 class="achievement-title" style="color: #F5F5DC;">{{ achievement.title }}</h4>
                <p class="achievement-date" style="color: #A7A7A7;">{{ achievement.date | date:'mediumDate' }}</p>
                <p class="achievement-description" style="color: #F1F1F1;">{{ achievement.description }}</p>
              </div>
              <div class="achievement-actions">
                <p-button 
                  icon="pi pi-pencil" 
                  severity="secondary"
                  (onClick)="editAchievement(achievement)"
                  class="action-btn"
                  [style]="{'background-color': 'rgba(176, 62, 255, 0.2)', 'border-color': 'rgba(176, 62, 255, 0.3)'}">
                </p-button>
                <p-button 
                  icon="pi pi-trash" 
                  severity="danger"
                  (onClick)="deleteAchievement(achievement.id)"
                  class="action-btn">
                </p-button>
              </div>
            </div>

            <div class="achievement-edit" *ngIf="achievement.isEditing">
              <div class="edit-inputs">
                <input pInputText [(ngModel)]="achievement.title" placeholder="Achievement title" class="edit-input" style="background-color: #252525; color: #F1F1F1; border: 1px solid rgba(176, 62, 255, 0.3);">
                <input pInputText type="date" [(ngModel)]="achievement.date" class="edit-input" style="background-color: #252525; color: #F1F1F1; border: 1px solid rgba(176, 62, 255, 0.3);">
                <textarea 
                  pInputTextarea 
                  [(ngModel)]="achievement.description" 
                  placeholder="Description"
                  rows="3"
                  class="edit-input"
                  style="background-color: #252525; color: #F1F1F1; border: 1px solid rgba(176, 62, 255, 0.3);">
                </textarea>
              </div>
              <div class="edit-actions">
                <p-button 
                  icon="pi pi-check" 
                  severity="success"
                  (onClick)="saveAchievement(achievement)"
                  class="action-btn">
                </p-button>
                <p-button 
                  icon="pi pi-times" 
                  severity="secondary"
                  (onClick)="achievement.isEditing = false"
                  class="action-btn"
                  [style]="{'background-color': 'rgba(176, 62, 255, 0.2)', 'border-color': 'rgba(176, 62, 255, 0.3)'}">
                </p-button>
              </div>
            </div>
          </div>
        </div>
      </p-card>
    </div>
  </div>

  <!-- Add Skill Dialog -->
  <p-dialog 
    header="Add New Skill" 
    [(visible)]="showAddSkillDialog" 
    [modal]="true"
    [style]="{width: '500px', 'background-color': '#1A1A1A', 'color': '#F1F1F1'}"
    styleClass="custom-dialog"
    class="add-dialog">
    <div class="dialog-content">
      <div class="form-group">
        <label>Skill Name:</label>
        <input pInputText [(ngModel)]="newSkill.name" placeholder="e.g., JavaScript">
      </div>
      <div class="form-group">
        <label>Category:</label>
        <input pInputText [(ngModel)]="newSkill.category" placeholder="e.g., Programming">
      </div>
      <div class="form-group">
        <label>Level:</label>
        <select pInputText [(ngModel)]="newSkill.level" class="edit-input">
          <option value="">Select Level</option>
          <option value="Beginner">Beginner</option>
          <option value="Intermediate">Intermediate</option>
          <option value="Advanced">Advanced</option>
          <option value="Expert">Expert</option>
        </select>
      </div>
    </div>
    <ng-template pTemplate="footer">
      <p-button label="Cancel" icon="pi pi-times" (onClick)="showAddSkillDialog = false" severity="secondary"></p-button>
      <p-button label="Add Skill" icon="pi pi-check" (onClick)="addSkill()" severity="success"></p-button>
    </ng-template>
  </p-dialog>

  <!-- Add Certification Dialog -->
  <p-dialog 
    header="Add New Certification" 
    [(visible)]="showAddCertificationDialog" 
    [modal]="true"
    [style]="{width: '500px', 'background-color': '#1A1A1A', 'color': '#F1F1F1'}"
    styleClass="custom-dialog"
    class="add-dialog">
    <div class="dialog-content">
      <div class="form-group">
        <label>Certification Name:</label>
        <input pInputText [(ngModel)]="newCertification.name" placeholder="e.g., AWS Certified Solutions Architect">
      </div>
      <div class="form-group">
        <label>Issuing Organization:</label>
        <input pInputText [(ngModel)]="newCertification.issuer" placeholder="e.g., Amazon Web Services">
      </div>
      <div class="form-group">
        <label>Date:</label>
        <input pInputText type="date" [(ngModel)]="newCertification.date">
      </div>
      <div class="form-group">
        <label>Description:</label>
        <textarea pInputTextarea [(ngModel)]="newCertification.description" rows="3" placeholder="Brief description of the certification"></textarea>
      </div>
    </div>
    <ng-template pTemplate="footer">
      <p-button label="Cancel" icon="pi pi-times" (onClick)="showAddCertificationDialog = false" severity="secondary"></p-button>
      <p-button label="Add Certification" icon="pi pi-check" (onClick)="addCertification()" severity="success"></p-button>
    </ng-template>
  </p-dialog>

  <!-- Add Achievement Dialog -->
  <p-dialog 
    header="Add New Achievement" 
    [(visible)]="showAddAchievementDialog" 
    [modal]="true"
    [style]="{width: '500px', 'background-color': '#1A1A1A', 'color': '#F1F1F1'}"
    styleClass="custom-dialog"
    class="add-dialog">
    <div class="dialog-content">
      <div class="form-group">
        <label>Achievement Title:</label>
        <input pInputText [(ngModel)]="newAchievement.title" placeholder="e.g., Best Developer Award">
      </div>
      <div class="form-group">
        <label>Date:</label>
        <input pInputText type="date" [(ngModel)]="newAchievement.date">
      </div>
      <div class="form-group">
        <label>Description:</label>
        <textarea pInputTextarea [(ngModel)]="newAchievement.description" rows="3" placeholder="Brief description of the achievement"></textarea>
      </div>
    </div>
    <ng-template pTemplate="footer">
      <p-button label="Cancel" icon="pi pi-times" (onClick)="showAddAchievementDialog = false" severity="secondary"></p-button>
      <p-button label="Add Achievement" icon="pi pi-check" (onClick)="addAchievement()" severity="success"></p-button>
    </ng-template>
  </p-dialog>
</div>
